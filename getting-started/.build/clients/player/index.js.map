{"version":3,"names":["Client","launcher","createLayout","config","window","SOUNDWORKS_CONFIG","main","$container","client","register","initScreensContainer","start","globals","stateManager","attach","console","log","getValues","onUpdate","updates","trigger","style","backgroundColor","setTimeout","innerHTML","addEventListener","set","err","error","execute","numClients","parseInt","URLSearchParams","location","search","get"],"sources":["../../../src/clients/player/index.js"],"sourcesContent":["import '@soundworks/helpers/polyfills.js';\nimport { Client } from '@soundworks/core/client.js';\nimport launcher from '@soundworks/helpers/launcher.js';\n\nimport createLayout from './views/layout.js';\n\n// - General documentation: https://soundworks.dev/\n// - API documentation:     https://soundworks.dev/api\n// - Issue Tracker:         https://github.com/collective-soundworks/soundworks/issues\n// - Wizard & Tools:        `npx soundworks`\n\n/**\n * Grab the configuration object written by the server in the `index.html`\n */\nconst config = window.SOUNDWORKS_CONFIG;\n\n/**\n * If multiple clients are emulated you might to want to share some resources\n */\n// const audioContext = new AudioContext();\n\nasync function main($container) {\n  try {\n    /**\n     * Create the soundworks client\n     */\n    const client = new Client(config);\n\n    /**\n     * Register some soundworks plugins, you will need to install the plugins\n     * before hand (run `npx soundworks` for help)\n     */\n    // client.pluginManager.register('platform', pluginPlatform, { audioContext });\n\n    /**\n     * Register the soundworks client into the launcher\n     *\n     * The launcher will do a bunch of stuff for you:\n     * - Display default initialization screens. If you want to change the provided\n     * initialization screens, you can import all the helpers directly in your\n     * application by doing `npx soundworks --eject-helpers`. You can also\n     * customise some global syles variables (background-color, text color etc.)\n     * in `src/clients/components/css/app.scss`.\n     * You can also change the default language of the intialization screen by\n     * setting, the `launcher.language` property, e.g.:\n     * `launcher.language = 'fr'`\n     * - By default the launcher automatically reloads the client when the socket\n     * closes or when the page is hidden. Such behavior can be quite important in\n     * performance situation where you don't want some phone getting stuck making\n     * noise without having any way left to stop it... Also be aware that a page\n     * in a background tab will have all its timers (setTimeout, etc.) put in very\n     * low priority, messing any scheduled events.\n     */\n    launcher.register(client, { initScreensContainer: $container });\n\n    /**\n     * Launch application\n     */\n    await client.start();\n\n    const globals = await client.stateManager.attach('globals');\n    console.log('globals shared state', globals.getValues());\n\n    globals.onUpdate(updates => {\n      console.log(updates);\n\n      if (updates.trigger) {\n        $container.style.backgroundColor = 'white';\n\n        setTimeout(() => {\n          $container.style.backgroundColor = 'black';\n        }, 150);\n      }\n    });\n\n    $container.innerHTML = `<h1 style=\"padding:20px;\">Click here!</h1>`;\n\n    $container.addEventListener('click', () => {\n      globals.set({ trigger: true });\n    });\n\n  } catch(err) {\n    console.error(err);\n  }\n}\n\n// The launcher enables instanciation of multiple clients in the same page to\n// facilitate development and testing.\n// e.g. `http://127.0.0.1:8000?emulate=10` to run 10 clients side-by-side\nlauncher.execute(main, {\n  numClients: parseInt(new URLSearchParams(window.location.search).get('emulate')) || 1,\n});\n"],"mappings":"AAAA,OAAO,kCAAkC;AACzC,SAASA,MAAM,QAAQ,4BAA4B;AACnD,OAAOC,QAAQ,MAAM,iCAAiC;AAEtD,OAAOC,YAAY,MAAM,mBAAmB;;AAE5C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAMC,MAAM,GAAGC,MAAM,CAACC,iBAAiB;;AAEvC;AACA;AACA;AACA;;AAEA,eAAeC,IAAI,CAACC,UAAU,EAAE;EAC9B,IAAI;IACF;AACJ;AACA;IACI,MAAMC,MAAM,GAAG,IAAIR,MAAM,CAACG,MAAM,CAAC;;IAEjC;AACJ;AACA;AACA;IACI;;IAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;IACIF,QAAQ,CAACQ,QAAQ,CAACD,MAAM,EAAE;MAAEE,oBAAoB,EAAEH;IAAW,CAAC,CAAC;;IAE/D;AACJ;AACA;IACI,MAAMC,MAAM,CAACG,KAAK,EAAE;IAEpB,MAAMC,OAAO,GAAG,MAAMJ,MAAM,CAACK,YAAY,CAACC,MAAM,CAAC,SAAS,CAAC;IAC3DC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEJ,OAAO,CAACK,SAAS,EAAE,CAAC;IAExDL,OAAO,CAACM,QAAQ,CAACC,OAAO,IAAI;MAC1BJ,OAAO,CAACC,GAAG,CAACG,OAAO,CAAC;MAEpB,IAAIA,OAAO,CAACC,OAAO,EAAE;QACnBb,UAAU,CAACc,KAAK,CAACC,eAAe,GAAG,OAAO;QAE1CC,UAAU,CAAC,MAAM;UACfhB,UAAU,CAACc,KAAK,CAACC,eAAe,GAAG,OAAO;QAC5C,CAAC,EAAE,GAAG,CAAC;MACT;IACF,CAAC,CAAC;IAEFf,UAAU,CAACiB,SAAS,GAAI,4CAA2C;IAEnEjB,UAAU,CAACkB,gBAAgB,CAAC,OAAO,EAAE,MAAM;MACzCb,OAAO,CAACc,GAAG,CAAC;QAAEN,OAAO,EAAE;MAAK,CAAC,CAAC;IAChC,CAAC,CAAC;EAEJ,CAAC,CAAC,OAAMO,GAAG,EAAE;IACXZ,OAAO,CAACa,KAAK,CAACD,GAAG,CAAC;EACpB;AACF;;AAEA;AACA;AACA;AACA1B,QAAQ,CAAC4B,OAAO,CAACvB,IAAI,EAAE;EACrBwB,UAAU,EAAEC,QAAQ,CAAC,IAAIC,eAAe,CAAC5B,MAAM,CAAC6B,QAAQ,CAACC,MAAM,CAAC,CAACC,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI;AACtF,CAAC,CAAC"}
